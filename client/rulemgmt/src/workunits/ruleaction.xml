<workunit>
    
    <invokers>
        <invoker type="ruleaction:open" action="open" caption="Edit Rule Action" target="popup" />
        <invoker type="ruleaction:create" action="create" caption="Create Rule Action" target="popup"/>
    </invokers>

    <!--
    notes: action parameter handlers must:
    implement
    -->
    <code>
        <![CDATA[    

        import com.rameses.rcp.annotations.*;
        import com.rameses.rcp.common.*;
        import com.rameses.osiris2.client.*;
        import com.rameses.osiris2.common.*;
        import com.rameses.rules.helpers.*;
         
        class RuleActionController  {
        
            @Binding
            def binding;
            
            def rule;
            def action;
            def saveHandler;
            def actionList;
            def varList;
            
            def selectedAction;
            
            def create() {
                action = [params:[:]];
                return "default";
            }
            
            def open() {
                if(action.params==null) action.params = [:];
                selectedAction = actionList.find{ it.name == action.name };                
                return selectAction();
            }

            def selectAction() {
                action.name = selectedAction.name;
                def handler = "actionhandler:basic";
                return InvokerUtil.lookupOpener(handler, [
                    rule:rule,
                    action:action,
                    actionDef: selectedAction,
                    saveHandler: saveHandler,
                    varList: varList
                ]);
            }
            
        }
        
        ]]>
        
    </code>
    
    <pages>
        <page name="default" template="com.rameses.rules.ui.SelectActionPage"/>
    </pages>
    
</workunit>