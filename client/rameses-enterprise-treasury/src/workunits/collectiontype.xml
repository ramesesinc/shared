<workunit>
    
   <invokers>
         <invoker type="collectiontype:open" caption="Collection Type" action="open"/>
         <invoker type="collectiontype:create" caption="Collection Type" action="create"/>
   </invokers>
   
   <code>
       <![CDATA[
        import com.rameses.osiris2.common.*;
        import com.rameses.rcp.common.*;
        import com.rameses.rcp.annotations.*;
        import com.rameses.osiris2.client.*;
        
        class CollectionTypeController extends CRUDController {
        
            @Service("CollectionTypeService")
            def service;
            
            String entityName = "collectiontype";
            String prefixId = "COLLTYPE";
            def selectedForm;
            
           
            @PropertyChangeListener
            def listener = [
                "selectedForm" : { o->
                    entity.formno = o.formno;
                }
            ]
            
            def getFormTypes() {
                return service.getFormTypes();
            }
            
            def getHandlers() {
                return InvokerUtil.lookupOpeners( "collectiontype:handler" ).collect {
                    [ 
                        name:it.properties.name,  
                        caption: it.caption,
                        formno: it.properties.formno,
                        formtype:it.properties.formtype
                    ]
                }.findAll {
                    return ((it.formno == selectedForm.formno ) || (it.formtype == selectedForm.formtype ))
                };
            }   
        }      
       ]]>
   </code>
   
   <pages>
       <page template="com.rameses.enterprise.treasury.collection.CollectionTypePage" />
   </pages>
   
</workunit>