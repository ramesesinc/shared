import com.rameses.annotations.*
import com.rameses.common.*
import java.rmi.server.UID;
import com.rameses.util.*;
import com.rameses.io.*;
import com.rameses.services.extended.*;

class UserSecuritygroupService extends ActiveCrudService {

	@ActiveDB(value='usersecuritygroup', em='admin')
	def em;

	@ProxyMethod 
	public List getList( params ) {
		if (!params.objid) throw new Exception('Please specify usergroupid');
		return em.getList([usergroupid: params.objid]);
	}

	@ProxyMethod 
	public void addSecuritygroup( params ) {
		if (!params.usergroupid) 
			throw new Exception('Please specify usergroupid');
		if (!params.securitygroupid) 
			throw new Exception('Please specify securitygroupid');
		if (!params.userid) 
			throw new Exception('Please specify userid');

		def info = em.read([objid: params.securitygroupid]);
		if (!info) throw new Exception("'"+params.securitygroupid+"' security group not found"); 

		entity.jobtitle = entity.user.jobtitle;
		em.create(entity); 
	}

	@ProxyMethod 
	public void removeMembership( params ) { 
		if (!params.objid) throw new Exception('Please specify objid'); 
		if (!params.userid) throw new Exception('Please specify userid'); 

		em.removeMembership(params);
	} 
}
