import com.rameses.annotations.*;
import com.rameses.util.*;
import com.rameses.services.extended.*;

class WebBasicPasswordService
{
	@Service('PasswordService')
	def passSvc;

	@ProxyMethod
	public void changePasswordOnLogin(params) {
		if (!params.newpassword) 
			throw new Exception('Please specify newpassword'); 
		if (!params.confirmpassword) 
			throw new Exception('Please specify confirmpassword'); 
		if (params.newpassword != params.confirmpassword) 
			throw new Exception('New password and Confirm password must be the same'); 

		params.type = 'changepwdonlogin';
		passSvc.changePassword(params); 
	}

	@ProxyMethod
	public void changePassword(params) {
		if (!params.oldpassword) throw new Exception('Please specify oldpassword'); 		
		if (!params.newpassword) throw new Exception('Please specify newpassword'); 
		if (!params.confirmpassword) throw new Exception('Please specify confirmpassword'); 

		if (params.newpassword == params.oldpassword) 
			throw new Exception('New password and Old password must not be the same'); 			
		if (params.newpassword != params.confirmpassword) 
			throw new Exception('New password and Confirm password must be the same'); 

		params.type = 'changepwd';
		passSvc.changePassword(params); 
	}	
}